version: '3'

tasks:
  npm:
    dir: '{{.USER_WORKING_DIR}}/packaging/npm'
    cmds:
      - npm {{.CLI_ARGS}}

  release-*:
    vars:
      VERSION: '{{index .MATCH 0}}'
    cmds:
      - ./versionmanager VERSION="{{.VERSION}}"
      - git add ./internal/version/version.go
      - git commit -m "ðŸ”– release version {{.VERSION}}"
      - git tag {{index .MATCH 0}}
      # - git push origin
      # - git push origin --tags
    preconditions:
      - test "$(git rev-parse --abbrev-ref HEAD)" = "main"
